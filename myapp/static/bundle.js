(()=>{const o=L.map("map",{minZoom:-2,crs:L.CRS.Simple,maxBounds:[[0,0],[5144,7260]]});var n=[[0,0],[5144,7260]],a=L.Icon.extend({options:{iconSize:[38,65],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-100]}});L.imageOverlay('{% static "san_joaquin_v2.webp" %}',n).addTo(o),o.fitBounds(n);var e={vidrio:new a({iconUrl:"/static/marker_icon_green.png"}),normal:new a({iconUrl:"/static/marker_icon_red.png"}),papel:new a({iconUrl:"/static/marker_icon_blue.png"}),plastico:new a({iconUrl:"/static/marker_icon_yellow.png"}),latas:new a({iconUrl:"/static/marker_icon_black.png"})},t={};for(var r in e)t[r]=L.layerGroup().addTo(o);L.control.layers(null,t).addTo(o);var i=L.popup();o.on("click",(function(n){var a=document.createElement("div"),e=n.latlng.lat,t=n.latlng.lng;a.innerHTML="Deseas solicitar un marcador en "+e.toFixed().toString()+", "+t.toFixed().toString()+'?<br><br>Elegir tipo de marcador: <select id="markerType">   <option value="normal">Normal</option>   <option value="papel">Papel y cartón</option>   <option value="vidrio">Vidrio</option>   <option value="plastico">Botellas plásticas</option>   <option value="latas">Latas</option></select><br><br><button id="confirmButton">Solicitar</button>',a.querySelector("#confirmButton").addEventListener("click",(function(){var r=a.querySelector("#markerType").value;!function(o,n){fetch("/save_request/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mapa:"mapa6",x_coordinate:o.lat,y_coordinate:o.lng,tipo:n})}).then((o=>o.json())).then((o=>{console.log("Server response:",o)})).catch((o=>{console.error("Error:",o)}))}(n.latlng,r),alert("Tipo de marcador: "+r+"\nCoordenadas: "+e.toFixed()+", "+t.toFixed()+"\n¡Tu solicitud se ha enviado con éxito!"),o.closePopup()})),i.setLatLng(n.latlng).setContent(a).openOn(o)}));for(var l=0;l<markersData.length;l++){var c=markersData[l],p=c.fields.tipo,s=e[p],d=L.marker([c.fields.x_coordinate,c.fields.y_coordinate],{icon:s});t[p].addLayer(d);var u="<strong>"+p+"</strong><br/><button onclick=\"handleButtonClick('"+c.pk+"')\">Eliminar Marcador</button>";d.bindPopup(u)}})();